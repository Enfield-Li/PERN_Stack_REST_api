generator client {
  provider = "prisma-client-js"
  previewFeatures = ["fullTextSearch"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  id           Int            @id() @default(autoincrement())
  createdAt    DateTime       @default(now()) @unique() 
  updatedAt    DateTime       @default(now()) @unique()
  username     String         @unique() @db.VarChar
  email        String         @unique() @db.VarChar
  password     String         @db.VarChar
  postAmounts  Int            @default(0)
  post         post[]
  interactions interactions[]
  comments     comments[]
}

model post {
  id             Int            @id() @default(autoincrement())
  createdAt      DateTime       @default(now()) @unique()
  updatedAt      DateTime       @default(now()) @unique()
  title          String         @db.VarChar
  content        String?        @db.VarChar
  userId         Int  
  viewCount      Int            @default(0)  
  votePoints     Int            @default(0)
  likePoints     Int            @default(0)
  confusedPoints Int            @default(0)
  commentAmounts Int            @default(0)
  laughPoints    Int            @default(0)
  user           user           @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  interactions   interactions[]
  comments       comments[]
}

model interactions {
  voteStatus     Boolean?
  likeStatus     Boolean?
  laughStatus    Boolean?
  confusedStatus Boolean?
  createdAt      DateTime @default(now()) @unique()
  userId         Int
  postId         Int
  post           post     @relation(fields: [postId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user           user     @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([userId, postId])
}

model comments {
  id           Int      @id @default(autoincrement())
  createdAt    DateTime @default(now()) @unique()
  updatedAt    DateTime @default(now()) @unique()
  comment_text String   @db.VarChar
  parentId     Int?
  userId       Int
  postId       Int
  user         user     @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  post         post     @relation(fields: [postId], references: [id], onDelete: Cascade, onUpdate: NoAction)
}
